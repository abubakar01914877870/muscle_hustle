{% extends "base.html" %}

{% block title %}{{ exercise.name }} - Muscle Hustle{% endblock %}

{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='design-system.css') }}">

<style>
  .exercise-detail-header {
    background: linear-gradient(135deg, var(--orange) 0%, var(--color-orange-500) 100%);
    color: var(--color-white);
    padding: var(--space-32);
    margin: calc(var(--space-24) * -1) calc(var(--space-32) * -1) var(--space-32);
    box-shadow: var(--shadow-md);
  }

  .exercise-detail-content {
    max-width: 1200px;
    margin: 0 auto;
  }

  .exercise-detail-title {
    font-size: var(--font-size-4xl);
    font-weight: var(--font-weight-bold);
    margin-bottom: var(--space-16);
  }

  .exercise-detail-badges {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-12);
  }

  .badge-large {
    padding: var(--space-8) var(--space-16);
    border-radius: var(--radius-full);
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-medium);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    background-color: rgba(255, 255, 255, 0.2);
  }

  .exercise-media {
    width: 100%;
    margin-bottom: var(--space-32);
    background-color: var(--color-surface);
    border: 1px solid var(--color-card-border);
    border-radius: var(--radius-lg);
    overflow: hidden;
    box-shadow: var(--shadow-sm);
  }

  .exercise-media img {
    width: 100%;
    height: auto;
    display: block;
  }

  .exercise-media iframe {
    width: 100%;
    height: 450px;
    border: none;
    display: block;
  }

  .detail-grid {
    display: grid;
    grid-template-columns: 2fr 1fr;
    gap: var(--space-32);
    margin-bottom: var(--space-32);
  }

  .detail-section {
    background-color: var(--color-surface);
    border: 1px solid var(--color-card-border);
    border-radius: var(--radius-lg);
    padding: var(--space-24);
    box-shadow: var(--shadow-sm);
  }

  .detail-section h2 {
    font-size: var(--font-size-xl);
    font-weight: var(--font-weight-semibold);
    margin-bottom: var(--space-16);
    color: var(--color-text);
  }

  .detail-section p,
  .detail-section ul {
    color: var(--color-text-secondary);
    line-height: 1.6;
  }

  .detail-section ul {
    padding-left: var(--space-20);
  }

  .detail-section li {
    margin-bottom: var(--space-8);
  }

  .info-item {
    display: flex;
    justify-content: space-between;
    padding: var(--space-12) 0;
    border-bottom: 1px solid var(--color-border);
  }

  .info-item:last-child {
    border-bottom: none;
  }

  .info-label {
    font-weight: var(--font-weight-medium);
    color: var(--color-text);
  }

  .info-value {
    color: var(--color-text-secondary);
  }

  .action-buttons {
    display: flex;
    gap: var(--space-12);
    margin-top: var(--space-24);
  }

  .btn {
    padding: var(--space-10) var(--space-24);
    border: none;
    border-radius: var(--radius-base);
    font-size: var(--font-size-md);
    font-weight: var(--font-weight-medium);
    cursor: pointer;
    transition: all var(--duration-fast) var(--ease-standard);
    text-decoration: none;
    display: inline-block;
  }

  .btn-primary {
    background-color: var(--color-primary);
    color: var(--color-btn-primary-text);
  }

  .btn-primary:hover {
    background-color: var(--color-primary-hover);
  }

  .btn-secondary {
    background-color: var(--color-secondary);
    color: var(--color-text);
    border: 1px solid var(--color-border);
  }

  .btn-secondary:hover {
    background-color: var(--color-secondary-hover);
  }

  .btn-danger {
    background-color: var(--color-error);
    color: var(--color-white);
  }

  .btn-danger:hover {
    opacity: 0.9;
  }

  @media (max-width: 768px) {
    .detail-grid {
      grid-template-columns: 1fr;
    }
  }
</style>

<div class="exercise-detail-header">
  <div class="exercise-detail-content">
    <h1 class="exercise-detail-title">{{ exercise.name }}</h1>
    <div class="exercise-detail-badges">
      <span class="badge-large">{{ exercise.muscle }}</span>
      <span class="badge-large">{{ exercise.equipment }}</span>
      <span class="badge-large">{{ exercise.difficulty }}</span>
      <span class="badge-large">{{ exercise.type }}</span>
    </div>
  </div>
</div>

{% if exercise.media_type == 'image' and exercise.image_data %}
<div class="exercise-media">
  <img src="{{ exercise.get_image_url() }}" alt="{{ exercise.name }}">
</div>
{% elif exercise.media_type == 'video' and exercise.video_url %}
<div class="exercise-media">
  <iframe src="{{ exercise.video_url }}" frameborder="0"
    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
    allowfullscreen></iframe>
</div>
{% endif %}

<div class="detail-grid">
  <div>
    {% if exercise.description %}
    <div class="detail-section">
      <h2>Description</h2>
      <div>{{ exercise.description|safe }}</div>
    </div>
    {% endif %}

    {% if exercise.instructions %}
    <div class="detail-section">
      <h2>Instructions</h2>
      <div>{{ exercise.instructions|safe }}</div>
    </div>
    {% endif %}

    {% if exercise.tips %}
    <div class="detail-section">
      <h2>Tips & Safety</h2>
      <div>{{ exercise.tips|safe }}</div>
    </div>
    {% endif %}

    {% if exercise.common_mistakes %}
    <div class="detail-section">
      <h2>Common Mistakes</h2>
      <div>{{ exercise.common_mistakes|safe }}</div>
    </div>
    {% endif %}
  </div>

  <div>
    <div class="detail-section">
      <h2>Exercise Info</h2>
      <div class="info-item">
        <span class="info-label">Primary Muscle</span>
        <span class="info-value">{{ exercise.muscle }}</span>
      </div>
      {% if exercise.secondary_muscles %}
      <div class="info-item">
        <span class="info-label">Secondary Muscles</span>
        <span class="info-value">{{ exercise.secondary_muscles|join(', ') }}</span>
      </div>
      {% endif %}
      <div class="info-item">
        <span class="info-label">Equipment</span>
        <span class="info-value">{{ exercise.equipment }}</span>
      </div>
      <div class="info-item">
        <span class="info-label">Difficulty</span>
        <span class="info-value">{{ exercise.difficulty }}</span>
      </div>
      <div class="info-item">
        <span class="info-label">Type</span>
        <span class="info-value">{{ exercise.type }}</span>
      </div>
      {% if exercise.reps_sets %}
      <div class="info-item">
        <span class="info-label">Target Reps/Sets</span>
        <span class="info-value">{{ exercise.reps_sets }}</span>
      </div>
      {% endif %}
    </div>

  </div>
</div>

<div class="action-buttons">
  <a href="{{ url_for('exercises.index') }}" class="btn btn-secondary">‚Üê Back to Exercises</a>
  {% if current_user.is_authenticated and current_user.is_admin %}
  <a href="{{ url_for('exercises.edit', exercise_id=exercise.id) }}" class="btn btn-primary">Edit Exercise</a>
  <form method="POST" action="{{ url_for('exercises.delete', exercise_id=exercise.id) }}" style="display: inline;"
    onsubmit="return confirm('Are you sure you want to delete this exercise?');">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
    <button type="submit" class="btn btn-danger">Delete Exercise</button>
  </form>
  {% endif %}
</div>

{% endblock %}